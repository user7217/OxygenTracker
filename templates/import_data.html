{% extends "base.html" %}

{% block title %}Import Data - Oxygen Cylinder Tracker{% endblock %}

{% block content %}
<div class="container">
    <div class="row mb-4">
        <div class="col">
            <h1 class="display-4 mb-3">
                <i class="bi bi-download me-3"></i>Import Data
            </h1>
            <p class="lead">Import existing data from MS Access databases</p>
        </div>
    </div>

    <div class="row justify-content-center">
        <div class="col-lg-8">
            <!-- Upload Form -->
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="bi bi-file-earmark-arrow-up me-2"></i>Upload Access Database
                    </h5>
                </div>
                <div class="card-body">
                    <form method="POST" action="{{ url_for('upload_access_file') }}" enctype="multipart/form-data">
                        <div class="mb-3">
                            <label for="access_file" class="form-label">Select Access Database File</label>
                            <input type="file" class="form-control" id="access_file" name="access_file" 
                                   accept=".mdb,.accdb" required>
                            <div class="form-text">
                                Supported formats: .mdb (Access 2003 and earlier), .accdb (Access 2007 and later)
                            </div>
                        </div>
                        
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-upload me-2"></i>Upload and Connect
                        </button>
                    </form>
                </div>
            </div>

            <!-- Information Card -->
            <div class="card mt-4">
                <div class="card-body">
                    <h6 class="card-title">
                        <i class="bi bi-info-circle me-2"></i>Import Process
                    </h6>
                    <div class="row">
                        <div class="col-md-6">
                            <h6 class="text-primary">Steps:</h6>
                            <ol class="mb-3">
                                <li>Upload your Access database file</li>
                                <li>Select tables to import</li>
                                <li>Map fields to match our system</li>
                                <li>Review and confirm import</li>
                            </ol>
                        </div>
                        <div class="col-md-6">
                            <h6 class="text-primary">âš¡ Ultra-Fast Import:</h6>
                            <ul class="mb-3">
                                <li>Instant processing of large datasets</li>
                                <li>Optimized for 100k+ records</li>
                                <li>Memory-based bulk operations</li>
                                <li>Past year transactions only</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Field Requirements -->
            <div class="card mt-4">
                <div class="card-body">
                    <h6 class="card-title">
                        <i class="bi bi-check-circle me-2"></i>Required Fields
                    </h6>
                    <div class="row">
                        <div class="col-md-6">
                            <h6 class="text-success">Customer Data:</h6>
                            <ul class="list-unstyled">
                                <li><i class="bi bi-check text-success me-2"></i>Name (required)</li>
                                <li><i class="bi bi-check text-success me-2"></i>Email (required)</li>
                                <li><i class="bi bi-check text-success me-2"></i>Phone (required)</li>
                                <li><i class="bi bi-check text-success me-2"></i>Address (required)</li>
                                <li><i class="bi bi-circle text-muted me-2"></i>Company (optional)</li>
                                <li><i class="bi bi-circle text-muted me-2"></i>Notes (optional)</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6 class="text-info">Cylinder Data:</h6>
                            <ul class="list-unstyled">
                                <li><i class="bi bi-check text-success me-2"></i>ID (required)</li>
                                <li><i class="bi bi-check text-success me-2"></i>Type (required)</li>
                                <li><i class="bi bi-check text-success me-2"></i>Size (required)</li>
                                <li><i class="bi bi-circle text-muted me-2"></i>Serial Number (optional)</li>
                                <li><i class="bi bi-circle text-muted me-2"></i>Status (defaults to "Available")</li>
                                <li><i class="bi bi-circle text-muted me-2"></i>Location (defaults to "Warehouse")</li>
                                <li><i class="bi bi-circle text-muted me-2"></i>Pressure (optional)</li>
                                <li><i class="bi bi-circle text-muted me-2"></i>Inspection dates (optional)</li>
                                <li><i class="bi bi-circle text-muted me-2"></i>Notes (optional)</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tips -->
            <div class="card mt-4">
                <div class="card-body">
                    <h6 class="card-title">
                        <i class="bi bi-lightbulb me-2"></i>Tips for Best Results
                    </h6>
                    <ul class="mb-0">
                        <li>Ensure your Access database is not password protected</li>
                        <li>Close the Access database before uploading</li>
                        <li>Use descriptive column names for better field mapping</li>
                        <li>Cylinder ID field is required - use memorable IDs like "A1", "B2", "001"</li>
                        <li>Serial numbers are optional for cylinders (many users don't track them)</li>
                        <li>Clean up data beforehand to avoid import errors</li>
                        <li>Backup your current data before importing</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}